<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contact List - WhatsApp Views</title>
  <link rel="icon" href="https://files.catbox.moe/owc52i.jpg" type="image/jpg" />

  <!-- Firebase (compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.1/firebase-database-compat.js"></script>

  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Segoe UI', sans-serif;
      background-color: #121212;
      color: #f1f1f1;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    h1 {
      color: #00f0ff;
      margin-bottom: 10px;
      text-align: center;
    }

    #count {
      color: #00eaff;
      font-weight: bold;
      margin-bottom: 20px;
    }

    .contact-list {
      width: 100%;
      max-width: 600px;
      background-color: #1e1e1e;
      border: 1px solid #00cfff;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0, 207, 255, 0.2);
      padding: 20px;
    }

    .contact-item {
      padding: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .contact-item:last-child {
      border-bottom: none;
    }

    .name {
      font-weight: bold;
      color: #00eaff;
    }

    .phone {
      color: #ccc;
    }

    .timestamp {
      font-size: 12px;
      color: #888;
    }

    .empty {
      color: #bbb;
      text-align: center;
      padding: 20px;
    }

    @media (max-width: 500px) {
      .contact-list {
        padding: 15px;
      }
    }
  </style>
</head>

<body>
  <h1>ðŸ“‡ Contact List</h1>
  <div id="count">Loading...</div>

  <div class="contact-list" id="contactList">
    <div class="empty">Loading contacts...</div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyA9jvwL_xzBBmn1kcbB0kLU-vbnMF0fs24",
      authDomain: "dyby-vcf-5f77c.firebaseapp.com",
      databaseURL: "https://dyby-vcf-5f77c-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "dyby-vcf-5f77c",
      storageBucket: "dyby-vcf-5f77c.firebasestorage.app",
      messagingSenderId: "686902317644",
      appId: "1:686902317644:web:1f94c4415b70dd883d5ae9",
      measurementId: "G-R8F1KW2JEE"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const listContainer = document.getElementById('contactList');
    const countDisplay = document.getElementById('count');

    db.ref('contacts').on('value', snapshot => {
      const data = snapshot.val();

      if (!data) {
        listContainer.innerHTML = '<div class="empty">No contacts found.</div>';
        countDisplay.textContent = "Total: 0 contact";
        return;
      }

      const contacts = Object.values(data).map(c => ({
        fullName: c.fullName || '',
        phone: c.phone || '',
        timestamp: c.timestamp || 0
      }));

      // Trier par ordre alphabÃ©tique
      contacts.sort((a, b) => a.fullName.localeCompare(b.fullName));

      // Affichage
      listContainer.innerHTML = contacts.map(c => {
        const date = c.timestamp
          ? new Date(c.timestamp).toLocaleString()
          : 'No timestamp';
        return `
          <div class="contact-item">
            <div class="name">${c.fullName}</div>
            <div class="phone">${c.phone}</div>
            <div class="timestamp">ðŸ“… Added: ${date}</div>
          </div>
        `;
      }).join('');

      countDisplay.textContent = `Total: ${contacts.length} contact${contacts.length > 1 ? 's' : ''}`;
    });
  </script>
</body>
</html>
